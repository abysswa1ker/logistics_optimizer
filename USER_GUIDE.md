# Посібник користувача - Оптимізація логістичної мережі v1.0

## 📖 Зміст

1. [Про програму](#про-програму)
2. [Швидкий старт](#швидкий-старт)
3. [Вибір методу оптимізації](#вибір-методу-оптимізації)
4. [Режим порівняння](#режим-порівняння)
5. [Експорт результатів](#експорт-результатів)
6. [Пакетне тестування](#пакетне-тестування)
7. [Розуміння результатів](#розуміння-результатів)
8. [Інтерпретація графіків](#інтерпретація-графіків)
9. [Часті питання](#часті-питання)

---

## Про програму

### Що робить програма?

Система оптимізації логістичної мережі допомагає знайти найкращу конфігурацію вашої дистрибуційної мережі, мінімізуючи загальні витрати.

**Програма автоматично:**
- 📍 Знаходить оптимальні позиції терміналів  
- 🔴 Вимикає невигідні термінали
- 📊 Розраховує всі витрати
- 🔬 Порівнює два методи оптимізації
- 📈 Показує економію у гривнях та відсотках
- 💾 Експортує результати в CSV для аналізу
- 🎨 Створює наочні графіки до/після

### Методи оптимізації

#### МПО (Метод покоординатного спуску)
- ✅ **Точний** - знаходить локальний оптимум
- ✅ **Детермінований** - однакові результати при кожному запуску
- ⚠️ **Повільніший** на великих мережах (n > 30)
- 🎯 **Використовуйте для:** невеликих мереж, коли потрібна відтворюваність

#### ЕМ-ГА (Генетичний алгоритм)
- ✅ **Швидкий** - особливо на великих мережах
- ✅ **Глобальний пошук** - уникає локальних мінімумів
- ✅ **Кращі рішення** - часто знаходить дешевші конфігурації
- ⚠️ **Стохастичний** - різні результати при кожному запуску
- 🎯 **Використовуйте для:** великих мереж, складних топологій

---

## Швидкий старт

### Крок 1: Встановлення

```bash
git clone https://github.com/abysswa1ker/logistics_optimizer.git
cd logistics_optimizer
pip install -r requirements.txt
```

### Крок 2: Запуск

```bash
python main.py
```

### Крок 3: Вибір файлу

```
============================================================
ДОСТУПНІ ФАЙЛИ ДАНИХ
============================================================
1. network_n15.csv
2. network_n20.csv
3. network_n25.csv
...
Оберіть файл (1-15): 1
```

### Крок 4: Вибір методу

```
============================================================
ВИБЕРІТЬ РЕЖИМ ОПТИМІЗАЦІЇ
============================================================
1. Тільки МПО (Метод покоординатного спуску)
2. Тільки ЕМ-ГА (Еволюційний метод - генетичний алгоритм)
3. Порівняння обох методів
4. Вихід
============================================================

Оберіть режим (1-4):
```

**Рекомендація для початківців:** Оберіть `3` (Порівняння) - побачите обидва методи!

---

## Вибір методу оптимізації

### Режим 1: Тільки МПО

**Коли використовувати:**
- Мережа невелика (<25 споживачів)
- Потрібен детермінований результат
- Для академічних цілей (відтворюваність)

**Вивід:**
```
============================================================
РЕЗУЛЬТАТИ ОПТИМІЗАЦІЇ
============================================================
Метод: МПО (Метод покоординатного спуску)
Початкові витрати:     66,486.31
Фінальні витрати:      52,600.48
────────────────────────────────
Покращення:            13,885.83 (20.89%)
Ітерацій:              2
Час виконання:         0.09 с
============================================================
```

### Режим 2: Тільки ЕМ-ГА

**Коли використовувати:**
- Велика мережа (>30 споживачів)
- Потрібна швидкість
- Складна топологія з кластерами

**Вивід:**
```
============================================================
РЕЗУЛЬТАТИ ОПТИМІЗАЦІЇ  
============================================================
Метод: ЕМ-ГА (Генетичний алгоритм)
Початкові витрати:     66,486.31
Фінальні витрати:      51,697.71
────────────────────────────────
Покращення:            14,788.60 (22.24%)
Поколінь:              50
Час виконання:         0.19 с
============================================================
```

### Режим 3: Порівняння (РЕКОМЕНДОВАНО)

**Коли використовувати:**
- Перший раз працюєте з мережею
- Потрібно знайти кращий метод
- Для дипломної роботи/дослідження

**Результат:**
```
╔══════════════════════════════════════════════════════════════════╗
║                ПОРІВНЯЛЬНИЙ АНАЛІЗ МЕТОДІВ                       ║
╚══════════════════════════════════════════════════════════════════╝

┌────────────────────┬──────────────┬──────────────┬──────────────┐
│ Параметр           │ МПО          │ ЕМ-ГА        │ Переможець   │
├────────────────────┼──────────────┼──────────────┼──────────────┤
│ Початкова вартість │ 66,486.31    │ 66,486.31    │ -            │
│ Кінцева вартість   │ 52,600.48    │ 51,697.71    │ ЕМ-ГА ✓      │
│ Покращення (абс)   │ 13,885.83    │ 14,788.60    │ ЕМ-ГА ✓      │
│ Покращення (%)     │ 20.89%       │ 22.24%       │ ЕМ-ГА ✓      │
│ Час виконання      │ 0.09 с       │ 0.19 с       │ МПО ✓        │
│ Активних терміналів│ 3            │ 3            │ Однаково     │
│ Ітерацій/Поколінь  │ 2            │ 50           │ -            │
├────────────────────┴──────────────┴──────────────┴──────────────┤
│ ✅ ВИСНОВОК: ЕМ-ГА знайшов кращий результат за 0.1 с             │
└──────────────────────────────────────────────────────────────────┘
```

---

## Режим порівняння

### Що відбувається

1. **МПО оптимізація** - запускається першою
2. **ЕМ-ГА оптимізація** - запускається другою
3. **Порівняння** - створюється таблиця
4. **Візуалізація** - графік з 3 стовпчиками
5. **Експорт** - результати обох методів у CSV

### Графік порівняння методів

**Файл:** `results/{filename}_methods_comparison.png`

Показує три стовпчики:
1. **До оптимізації** (червоний)
2. **Після МПО** (синій) - зі стрілкою економії
3. **Після ЕМ-ГА** (зелений) - зі стрілкою економії

**Стрілки показують:**
- Абсолютну економію (грн)
- Відносну економію (%)

### Інтерпретація

#### Сценарій 1: ЕМ-ГА краще

```
ЕМ-ГА кінцева вартість < МПО кінцева вартість
```

**Що робити:**
- ✅ Використовуйте рішення ЕМ-ГА
- 📊 ЕМ-ГА знайшов кращий глобальний мінімум
- 💡 Для цієї топології ГА ефективніше

#### Сценарій 2: МПО краще

```
МПО кінцева вартість < ЕМ-ГА кінцева вартість
```

**Що робити:**
- ✅ Використовуйте рішення МПО
- 📊 МПО знайшов точний локальний оптимум
- 💡 ГА може потребувати більше поколінь

#### Сценарій 3: Однаково

```
Різниця < 1%
```

**Що робити:**
- ✅ Обидва методи працюють добре
- 📊 Оберіть швидший (зазвичай ЕМ-ГА на великих n)
- 💡 Для відтворюваності оберіть МПО

---

## Експорт результатів

### Автоматичний експорт

Після кожної оптимізації створюється CSV файл.

### Формат файлу

**Одиночна оптимізація:**
```csv
sep=,
timestamp,dataset,method,initial_cost,final_cost,improvement_abs,improvement_pct,terminals_before,terminals_after,execution_time,iterations
2025-01-12 10:30:00,network_n15,MPO,66486.31,52600.48,13885.83,20.89,5,3,0.09,2
```

**Порівняння:**
```csv
sep=,
timestamp,dataset,method,initial_cost,final_cost,improvement_abs,improvement_pct,terminals_before,terminals_after,execution_time,iterations
2025-01-12 10:30:00,network_n15,MPO,66486.31,52600.48,13885.83,20.89,5,3,0.09,2
2025-01-12 10:30:00,network_n15,GA,66486.31,51697.71,14788.60,22.24,5,3,0.19,50
```

### Відкриття в Excel

**Windows (Excel з українськими налаштуваннями):**

Файл відкриється коректно завдяки `sep=,` на першому рядку!

**Якщо стовпці не розділились:**
1. Відкрийте CSV через "Дані" → "З тексту"
2. Оберіть роздільник: `,` (кома)
3. Кодування: UTF-8

### Використання для дипломної роботи

**Приклад таблиці для диплому:**

| n | Метод | Початкова вартість | Кінцева вартість | Покращення % | Час (с) |
|---|-------|-------------------|------------------|--------------|---------|
| 15 | МПО | 66,486 | 52,600 | 20.89% | 0.09 |
| 15 | ЕМ-ГА | 66,486 | 51,698 | 22.24% | 0.19 |
| 20 | МПО | 82,346 | 62,963 | 23.54% | 0.13 |
| 20 | ЕМ-ГА | 82,346 | 60,938 | 26.00% | 0.24 |

**Як створити:**
1. Запустіть `python utils/batch_test.py`
2. Відкрийте `results/batch_tests/performance_comparison.csv`
3. Скопіюйте дані в Word/LaTeX

---

## Пакетне тестування

### Призначення

Автоматичне тестування обох методів на всіх тестових мережах для валідації алгоритмів.

### Запуск

```bash
python utils/batch_test.py
```

### Що відбувається

```
============================================================
ПАКЕТНЕ ТЕСТУВАННЯ МЕТОДІВ ОПТИМІЗАЦІЇ
============================================================

============================================================
ТЕСТУВАННЯ МЕРЕЖІ n=15
============================================================
Завантаження: /path/to/data/network_n15.csv
Початкова вартість: 66486.31

--- МЕТОД ПАРАЛЕЛЬНОЇ ОПТИМІЗАЦІЇ (МПО) ---
Кінцева вартість: 52600.48
Покращення: 20.89%
Час виконання: 0.09 с

--- ЕВОЛЮЦІЙНО-МОДИФІКОВАНИЙ ГЕНЕТИЧНИЙ АЛГОРИТМ (ЕМ-ГА) ---
Кінцева вартість: 51697.71
Покращення: 22.24%
Час виконання: 0.19 с
Відносна похибка до МПО: -1.72%

... (повторюється для n=20, 25, 30, 35, 40)
```

### Зведена таблиця

```
================================================================================
ЗВЕДЕНА ТАБЛИЦЯ РЕЗУЛЬТАТІВ
================================================================================

  n |    δC(МПО) |  δC(ЕМ-ГА) |     T(МПО) |   T(ЕМ-ГА)
----+------------+------------+------------+-----------
 15 |      0.00% |     -1.72% |      0.09s |      0.19s
 20 |      0.00% |     -3.22% |      0.13s |      0.24s
 25 |      0.00% |     -1.43% |      0.32s |      0.36s
 30 |      0.00% |     -2.62% |      1.16s |      0.48s
 35 |      0.00% |     -2.13% |      1.40s |      0.59s
 40 |      0.00% |     -2.90% |      2.36s |      0.68s
```

### Інтерпретація δC

**δC(МПО) = 0%**
- МПО приймається за еталон (базову лінію)

**δC(ЕМ-ГА) = негативне значення**
- ЕМ-ГА знайшов КРАЩІ рішення (нижчу вартість)
- Приклад: δC = -2.62% означає ЕМ-ГА на 2.62% дешевше за МПО

**δC(ЕМ-ГА) = позитивне значення** (рідко)
- ЕМ-ГА знайшов гірші рішення  
- Можливо потрібно збільшити generations

### Експорт результатів

**Файл:** `results/batch_tests/performance_comparison.csv`

Містить:
- Початкову вартість для кожної мережі
- Результати МПО: вартість, час, ітерації
- Результати ЕМ-ГА: вартість, час, покоління
- Відносні похибки
- Покращення для обох методів

---

## Розуміння результатів

### Негативна похибка δC - це добре!

**Приклад:**
```
δC(ЕМ-ГА) = -2.90%
```

**Означає:**
- ЕМ-ГА знайшов рішення на 2.90% дешевше за МПО
- Це ПОЗИТИВНИЙ результат
- ЕМ-ГА краще оптимізував мережу

### Чому ЕМ-ГА часто краще?

1. **Глобальний пошук** vs локальний
2. **Популяція рішень** vs одне рішення  
3. **Випадковість допомагає** уникати локальних мінімумів
4. **Еволюція** знаходить неочевидні комбінації

### Швидкість виконання

**На малих мережах (n<25):**
- МПО швидше (0.08-0.32с)
- ЕМ-ГА повільніше (0.18-0.40с)

**На великих мережах (n>30):**
- МПО повільніше (1.16-2.36с)
- ЕМ-ГА швидше (0.48-0.68с)

**Висновок:** ЕМ-ГА масштабується краще!

---

## Інтерпретація графіків

### Графік мережі (до/після)

**Елементи:**
- 🔴 Червоний квадрат = Центр
- 🔺 Бірюзові трикутники = Активні термінали
- ❌ Сірі напівпрозорі хрестики = Неактивні термінали
- 🔵 Сині кружки = Споживачі
- 📏 Сірі лінії = З'єднання

**Покращення візуалізації:**
- Неактивні термінали менші (не перекривають споживачів)
- Без підписів на неактивних (уникає плутанини)
- Напівпрозорі (alpha=0.4)

### Графік порівняння витрат

Два графіки:

**Лівий:** Категорії витрат
- Фіксовані витрати терміналів
- Витрати на обробку
- Транспорт центр→термінали
- Транспорт термінали→споживачі

**Правий:** Загальні витрати
- До оптимізації
- Після оптимізації
- Стрілка зі значенням економії

### Графік порівняння методів

**Три стовпчики:**
1. До оптимізації (базова лінія)
2. Після МПО (зі стрілкою економії)
3. Після ЕМ-ГА (зі стрілкою економії)

**Як читати:**
- Нижчий стовпчик = краще
- Більша стрілка економії = краще
- Порівняйте висоту стовпчиків 2 і 3

---

## Часті питання

### Q: Чому ЕМ-ГА знаходить кращі рішення ніж МПО?

**A:** МПО - це локальний пошук. Він може застрягти в локальному мінімумі. ЕМ-ГА використовує популяцію рішень та генетичні оператори (кросовер, мутація), що дозволяє досліджувати простір рішень глобально та знаходити кращі комбінації терміналів.

### Q: Чому час виконання відрізняється від таблиці в статті?

**A:** Таблиці в наукових статтях часто створені на старому обладнанні. Сучасні процесори та оптимізації Python значно швидші. Важливо порівнювати **тренди** (час зростає з n), а не абсолютні значення.

### Q: Результати ЕМ-ГА відрізняються при кожному запуску?

**A:** Так, генетичний алгоритм стохастичний. Для відтворюваності додайте:
```python
import random
random.seed(42)
```
на початок файлу.

### Q: Як обрати розмір популяції для ЕМ-ГА?

**A:**
- Мала мережа (n<20): population=50
- Середня (20<n<35): population=100
- Велика (n>35): population=150-200

Більша популяція = кращі результати, але повільніше.

### Q: Скільки поколінь достатньо?

**A:**
- Зазвичай збіжність за 30-50 поколінь
- Для складних мереж: 100+ поколінь
- Дивіться на прогрес - якщо немає покращень 10+ поколінь, можна зупинити

### Q: Що робити якщо МПО працює занадто довго?

**A:** Зменшіть `max_iterations`:
```python
max_iterations=50  # замість 100
```

Або збільште `tolerance`:
```python
tolerance=1.0  # зупинка при покращенні < 1%
```

### Q: Як створити власну тестову мережу?

**A:**
1. Скопіюйте `data/network_n15.csv`
2. Відредагуйте координати та параметри
3. Збережіть як `data/my_network.csv`
4. Запустіть `python main.py` та оберіть ваш файл

### Q: Чи можу я експортувати результати в Excel?

**A:** Так! CSV файли відкриваються в Excel. Перший рядок `sep=,` автоматично налаштовує роздільник для українського Excel.

---

**Версія:** 1.0  
**Останнє оновлення:** 2025-01-12  
**Підтримка:** GitHub Issues

**Успішної оптимізації! 📊🚀**
